{"version":3,"file":"index.js","sources":["../src/MapPicker.tsx"],"sourcesContent":["import React, { FC } from 'react';\n\ntype Location = {\n    lat: number,\n    lng: number\n}\n\nenum MapTypeId {\n    Roadmap = 'roadmap',\n    Satellite = 'satellite',\n    Hybrid = 'hybrid',\n    Terrain = 'terrain'\n}\n\ntype Props = {\n    defaultLocation: Location;\n    zoom?: number;\n    onChangeLocation?(lat: number, lng: number): void;\n    onChangeZoom?(zoom: number): void;\n    style?: any;\n    className?: string;\n    mapTypeId?: MapTypeId\n}\n\nfunction isValidLocation(location: Location) {\n    return location && Math.abs(location.lat) <= 90 && Math.abs(location.lng) <= 180;\n}\n\n\nconst MapPicker: FC<Props> = ({ defaultLocation, zoom = 7, onChangeLocation, onChangeZoom, style, className, mapTypeId }) => {\n    const MAP_VIEW_ID = 'google-map-view-' + Math.random().toString(36).substr(2, 9);\n    const map = React.useRef<any>(null);\n    const marker = React.useRef<any>(null);\n\n    function handleChangeLocation() {\n        if (onChangeLocation) {\n            const currentLocation = marker.current.getPosition();\n            onChangeLocation(currentLocation.lat(), currentLocation.lng());\n        }\n    }\n\n    function handleChangeZoom() {\n        onChangeZoom && onChangeZoom(map.current.getZoom());\n    }\n\n    function loadMap() {\n        const Google = (window as any).google;\n        const validLocation = isValidLocation(defaultLocation) ? defaultLocation : { lat: 0, lng: 0 };\n\n        map.current = new Google.maps.Map(document.getElementById(MAP_VIEW_ID),\n            {\n                center: validLocation,\n                zoom: zoom,\n                ...(mapTypeId && { mapTypeId })\n            });\n\n        if (!marker.current) {\n            marker.current = new Google.maps.Marker({\n                position: validLocation,\n                map: map.current,\n                draggable: true\n            });\n            Google.maps.event.addListener(marker.current, 'dragend', handleChangeLocation);\n        } else {\n            marker.current.setPosition(validLocation);\n        }\n\n        map.current.addListener('click', function (event: any) {\n            const clickedLocation = event.latLng;\n\n            marker.current.setPosition(clickedLocation);\n            handleChangeLocation();\n        });\n\n        map.current.addListener('zoom_changed', handleChangeZoom);\n    }\n\n    React.useEffect(() => {\n        loadMap();\n    }, [])  // eslint-disable-line react-hooks/exhaustive-deps\n\n    React.useEffect(() => {\n        if (marker.current) {\n            map.current.setCenter(defaultLocation);\n            marker.current.setPosition(defaultLocation);\n        }\n    }, [defaultLocation]);\n\n    React.useEffect(() => {\n        if (map.current) {\n            map.current.setZoom(zoom);\n        }\n    }, [zoom]);\n\n    const componentStyle = Object.assign({ width: '100%', height: '600px' }, style || {});\n\n    return (\n        <div id={MAP_VIEW_ID} style={componentStyle} className={className}></div>\n    );\n};\nexport default MapPicker;"],"names":["MapTypeId","isValidLocation","location","Math","abs","lat","lng","MapPicker","defaultLocation","zoom","onChangeLocation","onChangeZoom","style","className","mapTypeId","MAP_VIEW_ID","random","toString","substr","map","React","useRef","marker","handleChangeLocation","currentLocation","current","getPosition","handleChangeZoom","getZoom","loadMap","Google","window","google","validLocation","maps","Map","document","getElementById","center","Marker","position","draggable","event","addListener","setPosition","clickedLocation","latLng","useEffect","setCenter","setZoom","componentStyle","Object","assign","width","height","id"],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAOA,IAAKA,SAAL;;AAAA,WAAKA;AACDA,EAAAA,oBAAA,YAAA;AACAA,EAAAA,sBAAA,cAAA;AACAA,EAAAA,mBAAA,WAAA;AACAA,EAAAA,oBAAA,YAAA;AACH,CALD,EAAKA,SAAS,KAATA,SAAS,KAAA,CAAd;;AAiBA,SAASC,eAAT,CAAyBC,QAAzB;AACI,SAAOA,QAAQ,IAAIC,IAAI,CAACC,GAAL,CAASF,QAAQ,CAACG,GAAlB,KAA0B,EAAtC,IAA4CF,IAAI,CAACC,GAAL,CAASF,QAAQ,CAACI,GAAlB,KAA0B,GAA7E;AACH;;AAGD,IAAMC,SAAS,GAAc,SAAvBA,SAAuB;MAAGC,uBAAAA;uBAAiBC;MAAAA,8BAAO;MAAGC,wBAAAA;MAAkBC,oBAAAA;MAAcC,aAAAA;MAAOC,iBAAAA;MAAWC,iBAAAA;AACzG,MAAMC,WAAW,GAAG,qBAAqBZ,IAAI,CAACa,MAAL,GAAcC,QAAd,CAAuB,EAAvB,EAA2BC,MAA3B,CAAkC,CAAlC,EAAqC,CAArC,CAAzC;AACA,MAAMC,GAAG,GAAGC,KAAK,CAACC,MAAN,CAAkB,IAAlB,CAAZ;AACA,MAAMC,MAAM,GAAGF,KAAK,CAACC,MAAN,CAAkB,IAAlB,CAAf;;AAEA,WAASE,oBAAT;AACI,QAAIb,gBAAJ,EAAsB;AAClB,UAAMc,eAAe,GAAGF,MAAM,CAACG,OAAP,CAAeC,WAAf,EAAxB;AACAhB,MAAAA,gBAAgB,CAACc,eAAe,CAACnB,GAAhB,EAAD,EAAwBmB,eAAe,CAAClB,GAAhB,EAAxB,CAAhB;AACH;AACJ;;AAED,WAASqB,gBAAT;AACIhB,IAAAA,YAAY,IAAIA,YAAY,CAACQ,GAAG,CAACM,OAAJ,CAAYG,OAAZ,EAAD,CAA5B;AACH;;AAED,WAASC,OAAT;AACI,QAAMC,MAAM,GAAIC,MAAc,CAACC,MAA/B;AACA,QAAMC,aAAa,GAAGhC,eAAe,CAACO,eAAD,CAAf,GAAmCA,eAAnC,GAAqD;AAAEH,MAAAA,GAAG,EAAE,CAAP;AAAUC,MAAAA,GAAG,EAAE;AAAf,KAA3E;AAEAa,IAAAA,GAAG,CAACM,OAAJ,GAAc,IAAIK,MAAM,CAACI,IAAP,CAAYC,GAAhB,CAAoBC,QAAQ,CAACC,cAAT,CAAwBtB,WAAxB,CAApB;AAENuB,MAAAA,MAAM,EAAEL,aAFF;AAGNxB,MAAAA,IAAI,EAAEA;AAHA,OAIFK,SAAS,IAAI;AAAEA,MAAAA,SAAS,EAATA;AAAF,KAJX,EAAd;;AAOA,QAAI,CAACQ,MAAM,CAACG,OAAZ,EAAqB;AACjBH,MAAAA,MAAM,CAACG,OAAP,GAAiB,IAAIK,MAAM,CAACI,IAAP,CAAYK,MAAhB,CAAuB;AACpCC,QAAAA,QAAQ,EAAEP,aAD0B;AAEpCd,QAAAA,GAAG,EAAEA,GAAG,CAACM,OAF2B;AAGpCgB,QAAAA,SAAS,EAAE;AAHyB,OAAvB,CAAjB;AAKAX,MAAAA,MAAM,CAACI,IAAP,CAAYQ,KAAZ,CAAkBC,WAAlB,CAA8BrB,MAAM,CAACG,OAArC,EAA8C,SAA9C,EAAyDF,oBAAzD;AACH,KAPD,MAOO;AACHD,MAAAA,MAAM,CAACG,OAAP,CAAemB,WAAf,CAA2BX,aAA3B;AACH;;AAEDd,IAAAA,GAAG,CAACM,OAAJ,CAAYkB,WAAZ,CAAwB,OAAxB,EAAiC,UAAUD,KAAV;AAC7B,UAAMG,eAAe,GAAGH,KAAK,CAACI,MAA9B;AAEAxB,MAAAA,MAAM,CAACG,OAAP,CAAemB,WAAf,CAA2BC,eAA3B;AACAtB,MAAAA,oBAAoB;AACvB,KALD;AAOAJ,IAAAA,GAAG,CAACM,OAAJ,CAAYkB,WAAZ,CAAwB,cAAxB,EAAwChB,gBAAxC;AACH;;AAEDP,EAAAA,KAAK,CAAC2B,SAAN,CAAgB;AACZlB,IAAAA,OAAO;AACV,GAFD,EAEG,EAFH;AAIAT,EAAAA,KAAK,CAAC2B,SAAN,CAAgB;AACZ,QAAIzB,MAAM,CAACG,OAAX,EAAoB;AAChBN,MAAAA,GAAG,CAACM,OAAJ,CAAYuB,SAAZ,CAAsBxC,eAAtB;AACAc,MAAAA,MAAM,CAACG,OAAP,CAAemB,WAAf,CAA2BpC,eAA3B;AACH;AACJ,GALD,EAKG,CAACA,eAAD,CALH;AAOAY,EAAAA,KAAK,CAAC2B,SAAN,CAAgB;AACZ,QAAI5B,GAAG,CAACM,OAAR,EAAiB;AACbN,MAAAA,GAAG,CAACM,OAAJ,CAAYwB,OAAZ,CAAoBxC,IAApB;AACH;AACJ,GAJD,EAIG,CAACA,IAAD,CAJH;AAMA,MAAMyC,cAAc,GAAGC,MAAM,CAACC,MAAP,CAAc;AAAEC,IAAAA,KAAK,EAAE,MAAT;AAAiBC,IAAAA,MAAM,EAAE;AAAzB,GAAd,EAAkD1C,KAAK,IAAI,EAA3D,CAAvB;AAEA,SACIQ,mBAAA,MAAA;AAAKmC,IAAAA,EAAE,EAAExC;AAAaH,IAAAA,KAAK,EAAEsC;AAAgBrC,IAAAA,SAAS,EAAEA;GAAxD,CADJ;AAGH,CAtED;;;;"}